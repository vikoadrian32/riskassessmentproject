<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VirusTotal Analysis</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0-alpha1/css/bootstrap.min.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
    
    <style>
        body {
            background-color: #333;
        }
        .container {
            margin-top: 50px;
        }
        .table th, .table td {
            vertical-align: middle;
            text-align: center;
        }
        .table tr {
            transition: background-color 0.3s ease;
        }
        .table tr:hover {
            background-color: #f1f1f1;
        }
        .alert {
            margin-top: 20px;
        }
        .harmless {
            background-color: #28a745;  /* Green for harmless */
            color: white;
            font-weight: bold;
        }
        .undetected {
            background-color: #17a2b8;  /* Blue for undetected */
            color: white;
            font-weight: bold;
        }
        .malicious {
            background-color: #dc3545;  /* Red for malicious */
            color: white;
            font-weight: bold;
        }
        .suspicious {
            background-color: #ffc107;  /* Yellow for suspicious */
            color: black;
            font-weight: bold;
        }
        .btn-primary {
            transition: background-color 0.3s ease, transform 0.2s ease;
        }
        .btn-primary:hover {
            background-color: #0056b3;
            transform: scale(1.05);
        }
        .form-control {
            transition: box-shadow 0.3s ease;
        }
        .form-control:focus {
            box-shadow: 0 0 10px rgba(0, 123, 255, 0.5);
        }
        .card {
            transition: transform 0.3s ease;
        }
        .card:hover {
            transform: scale(1.02);
        }
    </style>
</head>
<body>
<!-- Navbar -->
<nav class="navbar navbar-expand-lg navbar-dark bg-dark">
    <div class="container-fluid">
      <a class="navbar-brand m-2" href="#"><strong>VirusTotal Threat Intelligence</strong></a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
    </div>
</nav>
<div class="container">
    <a href="/" class="btn btn-secondary mt-3">Back to Home</a>
    <!-- <h2 class="text-center mb-4">VirusTotal Analysis</h2> -->

    <!-- VirusTotal Function Explanation and Brief Instructions -->
    <div class="alert alert-info">
        <strong>Welcome to VirusTotal Analysis Tool!</strong><br>
        <p>
            VirusTotal allows you to check whether a URL or file hash you submit contains potential threats such as viruses, malware, or phishing by using various antivirus engines. This application sends the URL or file hash to the VirusTotal API and displays the analysis results.
        </p>
        <p><strong>How to Use:</strong></p>
        <ol>
            <li>Enter the URL or file hash you want to check in the provided field.</li>
            <li>Click the "Submit" button.</li>
            <li>The analysis results will be displayed below the input form, indicating whether the URL or file is detected as malicious, harmless, or otherwise.</li>
        </ol>
        <p><strong>Note:</strong> If any results are detected as <strong>malicious</strong>, this page will visually alert you with a red background.</p>
        <p>For more details on how VirusTotal works and to explore additional features, visit <a href="https://www.virustotal.com" target="_blank">VirusTotal Official Website</a>.</p>
    </div>

    <form action="/virustotal" method="POST">
        <div class="my-3">
            <label for="url" class="form-label fw-bold text-white">Enter URL or Hash:</label>
            <input type="text" class="form-control" id="url" name="url" placeholder="Enter URL or file hash" required>
        </div>
        <button type="submit" class="btn btn-primary btn-block w-100"><i class="fas fa-search"></i> Scan</button>
    </form>

    {% if threats %}
        <div class="alert alert-info mt-4">
            <strong>Results for: {{ url }}</strong>
        </div>
        
        {% if threats.error %}
            <div class="alert alert-danger" role="alert">
                {{ threats.error }}
            </div>
        {% else %}
            <div class="card mt-4 shadow">
                <div class="card-body">
                    <h5 class="card-title text-center">Analysis Results</h5>
                    <table class="table table-striped table-bordered">
                        <thead>
                            <tr>
                                <th>Engine</th>
                                <th>Verdict</th>
                                <th>Scan Date</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for engine, result in threats.data.attributes.last_analysis_results.items() %}
                                <tr class="{% if result.category == 'harmless' %}harmless{% elif result.category == 'undetected' %}undetected{% elif result.category == 'malicious' %}malicious{% elif result.category == 'suspicious' %}suspicious{% else %}undetected{% endif %}">
                                    <td>{{ result.engine_name }}</td>
                                    <td>{{ result.category | capitalize }}</td>
                                    <td>{{ result.scan_date }}</td>
                                </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        {% endif %}
    {% endif %}
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0-alpha1/js/bootstrap.bundle.min.js"></script>
</body>
</html>
